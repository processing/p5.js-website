---
title: p5.Matrix
module: Math
file: src/math/p5.Matrix.js
description: >
  <p>A class to describe a matrix

  for model and view matrix manipulation in the p5js webgl renderer.

  The <code>Matrix</code> class represents a mathematical matrix and provides
  various methods for matrix operations.</p>

  <p>The <code>Matrix</code> class represents a mathematical matrix and provides
  various methods for matrix operations.

  This class extends the <code>MatrixInterface</code> and includes methods for
  creating, manipulating, and performing

  operations on matrices. It supports both 3x3 and 4x4 matrices, as well as
  general NxN matrices.</p>
line: 107
isConstructor: true
params:
  - name: mat4
    description: column-major array literal of our 4×4 matrix
    optional: 1
    type: Array
example:
  - |-
    // Creating a 3x3 matrix from an array using column major arrangement
    const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);

    // Creating a 4x4 identity matrix
    const identityMatrix = new p5.Matrix(4);

    // Adding two matrices
    const matrix1 = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);
    const matrix2 = new p5.Matrix([9, 8, 7, 6, 5, 4, 3, 2, 1]);
    matrix1.add(matrix2); // matrix1 is now [10, 10, 10, 10, 10, 10, 10, 10, 10]

    // Setting an element in the matrix
    matrix.setElement(0, 10); // matrix is now [10, 2, 3, 4, 5, 6, 7, 8, 9]

    // Resetting the matrix to an identity matrix
    matrix.reset();

    // Getting the diagonal elements of the matrix
    const diagonal = matrix.diagonal(); // [1, 1, 1]

    // Transposing the matrix
    matrix.transpose();

    // Multiplying two matrices
    matrix1.mult(matrix2);

    // Inverting the matrix
    matrix.invert();

    // Scaling the matrix
    matrix.scale(2, 2, 2);

    // Rotating the matrix around an axis
    matrix.rotate4x4(Math.PI / 4, 1, 0, 0);

    // Applying a perspective transformation
    matrix.perspective(Math.PI / 4, 1, 0.1, 100);

    // Applying an orthographic transformation
    matrix.ortho(-1, 1, -1, 1, 0.1, 100);

    // Multiplying a vector by the matrix
    const vector = new Vector(1, 2, 3);
    const result = matrix.multiplyPoint(vector);

    // p5.js script example
    <div class="norender"><code>
    function setup() {

      // Create a 4x4 identity matrix
      const matrix = new p5.Matrix(4);
      console.log("Original p5.Matrix:", matrix.matrix.toString()); // Output: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]

      // Add two matrices
      const matrix1 = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);
      const matrix2 = new p5.Matrix([9, 8, 7, 6, 5, 4, 3, 2, 1]);
      matrix1.add(matrix2);
      console.log("After Addition:", matrix1.matrix.toString()); // Output: [10, 10, 10, 10, 10, 10, 10, 10, 10]

      // Reset the matrix to an identity matrix
      matrix.reset();
      console.log("Reset p5.Matrix:", matrix.matrix.toString()); // [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]

      // Apply a scaling transformation
      matrix.scale(2, 2, 2);
      console.log("Scaled p5.Matrix:", matrix.matrix.toString()); // [2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 1]

      // Apply a rotation around the X-axis
      matrix.rotate4x4(Math.PI / 4, 1, 0, 0);
      console.log("Rotated p5.Matrix (X-axis):", matrix.matrix.toString()); // [2, 0, 0, 0, 0, 1.4142135381698608, 1.4142135381698608, 0, 0, -1.4142135381698608, 1.4142135381698608, 0, 0, 0, 0, 1]

      // Apply a perspective transformation
      matrix.perspective(Math.PI / 4, 1, 0.1, 100);
      console.log("Perspective p5.Matrix:", matrix.matrix.toString());// [2.4142136573791504, 0, 0, 0, 0, 2.4142136573791504, 0, 0, 0, 0, -1.0020020008087158, -1, 0, 0, -0.20020020008087158, 0]

      // Multiply a vector by the matrix
      const vector = new p5.Vector(1, 2, 3);
      const transformedVector = matrix.multiplyPoint(vector);
      console.log("Transformed Vector:", transformedVector.toString());
    }
    </code></div>
methods:
  add:
    description: >-
      Adds the corresponding elements of the given matrix to this matrix, if the
      dimentions are the same.
    path: p5.Matrix/add
  setElement:
    description: >
      <p>Sets the value of a specific element in the matrix in column-major
      order.</p>

      <p>A matrix is stored in column-major order, meaning elements are arranged
      column by column.

      This function allows you to update or change the value of a specific
      element

      in the matrix by specifying its index in the column-major order and the
      new value.</p>

      <p>Parameters:</p>

      <ul><li><code>index</code> (number): The position in the matrix where the
      value should be set.

      Indices start from 0 and follow column-major
      order.</li><li><code>value</code> (any): The new value you want to assign
      to the specified element.</li></ul><p>Example:

      If you have the following 3x3 matrix stored in column-major order:</p>

      <pre><code>[
        1, 4, 7,  // Column 1
        2, 5, 8,  // Column 2
        3, 6, 9   // Column 3
      ]</code></pre><p>Calling <code>setElement(4, 10)</code> will update the
      element at index 4

      (which corresponds to row 2, column 2 in row-major order) to
      <code>10</code>.

      The updated matrix will look like this:</p>

      <pre><code>[
        1, 4, 7,
        2, 10, 8,
        3, 6, 9
      ]</code></pre><p>This function is useful for modifying specific parts of
      the matrix without

      having to recreate the entire structure.</p>
    path: p5.Matrix/setElement
  reset:
    description: >
      <p>Resets the current matrix to an identity matrix.</p>

      <p>This method replaces the current matrix with an identity matrix of the
      same dimensions.

      An identity matrix is a square matrix with ones on the main diagonal and
      zeros elsewhere.

      This is useful for resetting transformations or starting fresh with a
      clean matrix.</p>
    path: p5.Matrix/reset
  set:
    description: >
      <p>Replace the entire contents of a NxN matrix.</p>

      <p>This method allows you to replace the values of the current matrix with

      those from another matrix, an array, or individual arguments. The input

      can be a <code>Matrix</code> instance, an array of numbers, or individual
      numbers

      that match the dimensions of the current matrix. The values are copied

      without referencing the source object, ensuring that the original input

      remains unchanged.</p>

      <p>If the input dimensions do not match the current matrix, an error will

      be thrown to ensure consistency.</p>
    path: p5.Matrix/set
  get:
    description: >
      <p>Gets a copy of the matrix, returns a p5.Matrix object.</p>

      <p>This method creates a new instance of the <code>Matrix</code> class and
      copies the

      current matrix values into it. The returned matrix is independent of the

      original, meaning changes to the copy will not affect the original
      matrix.</p>

      <p>This is useful when you need to preserve the current state of a matrix

      while performing operations on a duplicate.</p>
    path: p5.Matrix/get
  copy:
    description: >
      <p>Return a copy of this matrix.

      If this matrix is 4x4, a 4x4 matrix with exactly the same entries will be

      generated. The same is true if this matrix is 3x3 or any NxN matrix.</p>

      <p>This method is useful when you need to preserve the current state of a
      matrix

      while performing operations on a duplicate. The returned matrix is
      independent

      of the original, meaning changes to the copy will not affect the original
      matrix.</p>
    path: p5.Matrix/copy
  clone:
    description: |-
      Creates a copy of the current matrix instance.
      This method is useful when you need a duplicate of the matrix
      without modifying the original one.
    path: p5.Matrix/clone
  diagonal:
    description: >
      <p>Returns the diagonal elements of the matrix in the form of an array.

      A NxN matrix will return an array of length N.</p>

      <p>This method extracts the diagonal elements of the matrix, which are the

      elements where the row index equals the column index. For example, in a

      3x3 matrix:</p>

      <pre><code>[
        1, 2, 3,
        4, 5, 6,
        7, 8, 9
      ]</code></pre><p>The diagonal elements are [1, 5, 9].</p>

      <p>This is useful for operations that require the main diagonal of a
      matrix,

      such as calculating the trace of a matrix or verifying if a matrix is
      diagonal.</p>
    path: p5.Matrix/diagonal
  row:
    description: >
      <p>This function is only for 3x3 matrices A function that returns a row
      vector of a NxN matrix.</p>

      <p>This method extracts a specific row from the matrix and returns it as a
      <code>p5.Vector</code>.

      The row is determined by the <code>columnIndex</code> parameter, which
      specifies the column

      index of the matrix. This is useful for operations that require working
      with

      individual rows of a matrix, such as row transformations or dot
      products.</p>
    path: p5.Matrix/row
  column:
    description: >
      <p>A function that returns a column vector of a NxN matrix.</p>

      <p>This method extracts a specific column from the matrix and returns it
      as a <code>p5.Vector</code>.

      The column is determined by the <code>rowIndex</code> parameter, which
      specifies the row index

      of the matrix. This is useful for operations that require working with
      individual

      columns of a matrix, such as column transformations or dot products.</p>
    path: p5.Matrix/column
  transpose:
    description: >
      <p>Transposes the given matrix <code>a</code> based on the square
      dimension of the matrix.</p>

      <p>This method rearranges the elements of the matrix such that the rows
      become columns

      and the columns become rows. It handles matrices of different dimensions
      (4x4, 3x3, NxN)

      by delegating to specific transpose methods for each case.</p>

      <p>If no argument is provided, the method transposes the current matrix
      instance.

      If an argument is provided, it transposes the given matrix <code>a</code>
      and updates the current matrix.</p>
    path: p5.Matrix/transpose
  mult:
    description: >
      <p>Multiplies the current matrix with another matrix or matrix-like
      array.</p>

      <p>This method supports several types of input:</p>

      <ul><li>Another Matrix instance</li><li>A matrix-like array (must be a
      perfect square, e.g., 4x4 or 3x3)</li><li>Multiple arguments that form a
      perfect square matrix</li></ul><p>If the input is the same as the current
      matrix, a copy is made to avoid modifying the original matrix.</p>

      <p>The method determines the appropriate multiplication strategy based on
      the dimensions of the current matrix

      and the input matrix. It supports 3x3, 4x4, and NxN matrices.</p>
    path: p5.Matrix/mult
  multiplyVec:
    description: >
      <p>Takes a vector and returns the vector resulting from multiplying to
      that vector by this matrix from left. This function is only for 3x3
      matrices.</p>

      <p>This method applies the current 3x3 matrix to a given vector,
      effectively

      transforming the vector using the matrix. The resulting vector is returned

      as a new vector or stored in the provided target vector.</p>
    path: p5.Matrix/multiplyVec
  invert:
    description: >
      <p>Inverts a given matrix.</p>

      <p>This method inverts a matrix based on its dimensions. Currently, it
      supports

      3x3 and 4x4 matrices. If the matrix dimension is greater than 4, an error
      is thrown.</p>

      <p>For 4x4 matrices, it uses a specialized algorithm to compute the
      inverse.

      For 3x3 matrices, it uses a different algorithm optimized for smaller
      matrices.</p>

      <p>If the matrix is singular (non-invertible), the method will return
      <code>null</code>.</p>
    path: p5.Matrix/invert
  createSubMatrix3x3:
    description: >
      <p>Creates a 3x3 matrix whose entries are the top left 3x3 part and
      returns it. This function is only for 4x4 matrices.</p>

      <p>This method extracts the top-left 3x3 portion of a 4x4 matrix and
      creates a new

      3x3 matrix from it. This is particularly useful in 3D graphics for
      operations

      that require only the rotational or scaling components of a transformation
      matrix.</p>

      <p>If the current matrix is not 4x4, an error is thrown to ensure the
      method is used

      correctly. The resulting 3x3 matrix is independent of the original matrix,
      meaning

      changes to the new matrix will not affect the original.</p>
    path: p5.Matrix/createSubMatrix3x3
  inverseTranspose4x4:
    description: >
      <p>Converts a 4×4 matrix to its 3×3 inverse transpose transform.

      This is commonly used in MVMatrix to NMatrix conversions, particularly

      in 3D graphics for transforming normal vectors.</p>

      <p>This method extracts the top-left 3×3 portion of a 4×4 matrix, inverts
      it,

      and then transposes the result. If the matrix is singular
      (non-invertible),

      the resulting matrix will be zeroed out.</p>
    path: p5.Matrix/inverseTranspose4x4
  apply:
    description: >
      <p>Applies a transformation matrix to the current matrix.</p>

      <p>This method multiplies the current matrix by another matrix, which can
      be provided

      in several forms: another Matrix instance, an array representing a matrix,
      or as

      individual arguments representing the elements of a 4x4 matrix.</p>

      <p>This operation is useful for combining transformations such as
      translation, rotation,

      scaling, and perspective projection into a single matrix. By applying a
      transformation

      matrix, you can modify the current matrix to represent a new
      transformation.</p>
    path: p5.Matrix/apply
  scale:
    description: >
      <p>Scales a p5.Matrix by scalars or a vector.</p>

      <p>This method applies a scaling transformation to the current matrix.

      Scaling is a transformation that enlarges or shrinks objects by a scale
      factor

      along the x, y, and z axes. The scale factors can be provided as
      individual

      numbers, an array, or a <code>p5.Vector</code>.</p>

      <p>If a <code>p5.Vector</code> or an array is provided, the x, y, and z
      components are extracted

      from it. If the z component is not provided, it defaults to 1 (no scaling
      along the z-axis).</p>
    path: p5.Matrix/scale
  rotate4x4:
    description: >
      <p>Rotate the Matrix around a specified axis by a given angle.</p>

      <p>This method applies a rotation transformation to the matrix, modifying
      its orientation

      in 3D space. The rotation is performed around the provided axis, which can
      be defined

      as a <code>p5.Vector</code> or an array of numbers representing the x, y,
      and z components of the axis.

      Rotate our Matrix around an axis by the given angle.</p>
    path: p5.Matrix/rotate4x4
  translate:
    description: >
      <p>Translates the current matrix by a given vector.</p>

      <p>This method applies a translation transformation to the current matrix.

      Translation moves the matrix by a specified amount along the x, y, and z
      axes.

      The input vector can be a 2D or 3D vector. If the z-component is not
      provided,

      it defaults to 0, meaning no translation along the z-axis.</p>
    path: p5.Matrix/translate
  rotateX:
    description: >
      <p>Rotates the matrix around the X-axis by a given angle.</p>

      <p>This method modifies the current matrix to apply a rotation
      transformation

      around the X-axis. The rotation angle is specified in radians.</p>

      <p>Rotating around the X-axis means that the Y and Z coordinates of the
      matrix

      are transformed while the X coordinates remain unchanged. This is commonly

      used in 3D graphics to create animations or transformations along the
      X-axis.</p>
    path: p5.Matrix/rotateX
  rotateY:
    description: >
      <p>Rotates the matrix around the Y-axis by a given angle.</p>

      <p>This method modifies the current matrix to apply a rotation
      transformation

      around the Y-axis. The rotation is performed in 3D space, and the angle

      is specified in radians. Rotating around the Y-axis means that the X and Z

      coordinates of the matrix are transformed while the Y coordinates remain

      unchanged. This is commonly used in 3D graphics to create animations or

      transformations along the Y-axis.</p>
    path: p5.Matrix/rotateY
  rotateZ:
    description: >
      <p>Rotates the matrix around the Z-axis by a given angle.</p>

      <p>This method modifies the current matrix to apply a rotation
      transformation

      around the Z-axis. The rotation is performed in a 4x4 matrix context,
      which

      is commonly used in 3D graphics to handle transformations. Rotating around

      the Z-axis means that the X and Y coordinates of the matrix are
      transformed

      while the Z coordinates remain unchanged.</p>
    path: p5.Matrix/rotateZ
  perspective:
    description: >
      <p>Sets the perspective projection matrix.</p>

      <p>This method modifies the current matrix to represent a perspective
      projection.

      Perspective projection is commonly used in 3D graphics to simulate the
      effect

      of objects appearing smaller as they move further away from the
      camera.</p>

      <p>The perspective matrix is defined by the field of view (fovy), aspect
      ratio,

      and the near and far clipping planes. The near and far clipping planes
      define

      the range of depth that will be rendered, with anything outside this range

      being clipped.</p>
    path: p5.Matrix/perspective
  ortho:
    description: |
      <p>Sets this matrix to an orthographic projection matrix.</p>
      <p>An orthographic projection matrix is used to create a 2D rendering
      of a 3D scene by projecting points onto a plane without perspective
      distortion. This method modifies the current matrix to represent
      the orthographic projection defined by the given parameters.</p>
    path: p5.Matrix/ortho
  multiplyVec4:
    description: >
      <p>Applies a matrix to a vector with x, y, z, w components and returns the
      result as an array.</p>

      <p>This method multiplies the current matrix by a 4D vector (x, y, z, w)
      and computes the resulting vector.

      It is commonly used in 3D graphics for transformations such as
      translation, rotation, scaling, and perspective projection.</p>

      <p>The resulting vector is returned as an array of four numbers,
      representing the transformed x, y, z, and w components.</p>
    path: p5.Matrix/multiplyVec4
  multiplyPoint:
    description: |
      <p>Applies a matrix to a vector. The fourth component is set to 1.
      Returns a vector consisting of the first
      through third components of the result.</p>
      <p>This method multiplies the current matrix by a 4D vector (x, y, z, 1),
      effectively transforming the vector using the matrix. The resulting
      vector is returned as a new <code>p5.Vector</code> instance.</p>
      <p>This is useful for applying transformations such as translation,
      rotation, scaling, or perspective projection to a point in 3D space.</p>
    path: p5.Matrix/multiplyPoint
  multiplyAndNormalizePoint:
    description: >
      <p>Applies a matrix to a vector.

      The fourth component is set to 1.

      Returns the result of dividing the 1st to 3rd components

      of the result by the 4th component as a vector.</p>

      <p>This method multiplies the current matrix by a 4D vector (x, y, z, 1),

      effectively transforming the vector using the matrix. The resulting

      vector is normalized by dividing its x, y, and z components by the w
      component.

      This is useful for applying transformations such as perspective projection

      to a point in 3D space.</p>
    path: p5.Matrix/multiplyAndNormalizePoint
  multiplyDirection:
    description: >
      <p>Applies a matrix to a vector.

      The fourth component is set to 0.

      Returns a vector consisting of the first

      through third components of the result.</p>

      <p>This method multiplies the current matrix by a 4D vector (x, y, z, 0),

      effectively transforming the direction vector using the matrix. The
      resulting

      vector is returned as a new <code>p5.Vector</code> instance. This is
      particularly useful

      for transforming direction vectors (e.g., normals) without applying
      translation.</p>
    path: p5.Matrix/multiplyDirection
  multiplyVec3:
    description: >
      <p>Takes a vector and returns the vector resulting from multiplying. This
      function is only for 3x3 matrices.

      that vector by this matrix from the left.</p>

      <p>This method applies the current 3x3 matrix to a given vector,
      effectively

      transforming the vector using the matrix. The resulting vector is returned

      as a new vector or stored in the provided target vector.</p>

      <p>This is useful for operations such as transforming points or directions

      in 2D or 3D space using a 3x3 transformation matrix.</p>
    path: p5.Matrix/multiplyVec3
chainable: false
---


# p5.Matrix
